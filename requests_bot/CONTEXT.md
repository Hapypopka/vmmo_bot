# VMMO Requests Bot - –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## üéØ –ì–õ–ê–í–ù–ê–Ø –ó–ê–î–ê–ß–ê: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç —Å Playwright –Ω–∞ requests

–ü—Ä–∏—á–∏–Ω–∞: requests –±—ã—Å—Ç—Ä–µ–µ, –ª–µ–≥—á–µ, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –±—Ä–∞—É–∑–µ—Ä–∞.

---

## –°—Ç–∞—Ç—É—Å: –†–∞–±–æ—Ç–∞–µ—Ç!

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –ª–æ–≥–∏–Ω —á–µ—Ä–µ–∑ POST —Ñ–æ—Ä–º—É, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ cookies
2. **API –¥–∞–Ω–∂–µ–Ω–æ–≤** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–∞–Ω–∂–µ–Ω–æ–≤ —Å –ö–î —á–µ—Ä–µ–∑ JSON API
3. **–í—Ö–æ–¥ –≤ –¥–∞–Ω–∂–µ–Ω** - –ø–æ–ª–Ω—ã–π flow –æ—Ç –≤—ã–±–æ—Ä–∞ –¥–∞–Ω–∂–µ–Ω–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –±–æ—è
4. **–ë–æ–π** - –∞—Ç–∞–∫–∞ –∏ —Å–∫–∏–ª–ª—ã —á–µ—Ä–µ–∑ Wicket AJAX
5. **–ü–æ—á—Ç–∞** - —Å–±–æ—Ä –ø–∏—Å–µ–º –∏ –¥–µ–Ω–µ–≥ –∏–∑ –ø–æ—á—Ç—ã
6. **–†—é–∫–∑–∞–∫** - –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —Ä–∞–∑–±–æ—Ä–∫–∞, –≤—ã–±—Ä–æ—Å, –æ—Ç–∫—Ä—ã—Ç–∏–µ –±–æ–Ω—É—Å–æ–≤
7. **–ê—É–∫—Ü–∏–æ–Ω** - –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Å –∞–≤—Ç–æ—Ü–µ–Ω–æ–π –Ω–∞ 1—Å –Ω–∏–∂–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞

---

## –ü–æ–ª–Ω—ã–π Flow –≤—Ö–æ–¥–∞ –≤ –¥–∞–Ω–∂–µ–Ω

```
1. GET /dungeons?52           ‚Üí HTML —Å API URLs
2. GET {apiSectionUrl}        ‚Üí JSON —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–∂–µ–Ω–æ–≤ —Å –ö–î
3. GET {apiLinkUrl}&link_id=  ‚Üí JSON —Å redirect URL
4. GET /dungeon/landing/{id}/normal ‚Üí Landing page
5. GET {enterLink}            ‚Üí Lobby/Standby page
6. GET {linkStartCombat}      ‚Üí AJAX ‚Üí Combat URL
7. GET /dungeon/combat/{id}   ‚Üí Combat page —Å attack URLs
8. GET {attackLink}           ‚Üí AJAX attack
```

---

## API Dungeons

### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–µ–∫—Ü–∏–∏ (—Ç–∞–±—ã)
```
GET {apiSectionsUrl}
Accept: application/json

Response:
{
  "status": "OK",
  "player": {"lvl": 29},
  "sections": [
    {"id": "tab2", "lvls": [1, 29]},
    {"id": "tab3", "lvls": [30, 39]},
    ...
  ]
}
```

### 2. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–∂–µ–Ω—ã —Å–µ–∫—Ü–∏–∏
```
GET {apiSectionUrl}&section_id=tab2
Accept: application/json

Response:
{
  "status": "OK",
  "section": {
    "dungeons": [
      {
        "id": "dng:dSanctuary",
        "name": "–°–≤—è—Ç–∏–ª–∏—â–µ<br>–ù–∞–∫—Ä–∏–ª–∞",
        "lvl": 6,
        "cooldown": 0  // 0 = –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
      },
      ...
    ]
  }
}
```

### 3. –í–æ–π—Ç–∏ –≤ –¥–∞–Ω–∂–µ–Ω
```
GET {apiLinkUrl}&link_id=dng:dSanctuary  // –í–ê–ñ–ù–û: link_id, –Ω–µ dungeon_id!

Response:
{
  "status": "redirect",
  "url": "https://vmmo.vten.ru/dungeon/landing/dSanctuary"
}
```

### 4. Landing Page
```
GET /dungeon/landing/{dungeonId}/normal  // /normal –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞, –±–µ–∑ –Ω–µ–≥–æ - brutal
```

–ò—â–µ–º –∫–Ω–æ–ø–∫—É –≤—Ö–æ–¥–∞:
```python
re.search(r'href=["\']([^"\']*ILinkListener[^"\']*enterLinksPanel[^"\']*)["\']', html)
```

### 5. Lobby/Standby
–ü–æ—Å–ª–µ –∫–ª–∏–∫–∞ –Ω–∞ enter button –ø–æ–ø–∞–¥–∞–µ–º –≤ `/dungeon/standby/{id}?1=normal`

–î–≤–∞ —Ç–∏–ø–∞ —Å—Ç—Ä–∞–Ω–∏—Ü:
- **Standby**: –∫–Ω–æ–ø–∫–∞ `href="...?ppAction=combat"`
- **Lobby**: Wicket AJAX `linkStartCombat`

```python
# –î–ª—è Wicket AJAX
re.search(r'"u":"([^"]*linkStartCombat[^"]*)"', html)
```

### 6. Start Combat (AJAX)
```
GET {linkStartCombat}
Headers: Wicket-Ajax, X-Requested-With

Response (XML):
<ajax-response>
  <evaluate>Loading content for 'https://vmmo.vten.ru/dungeon/combat/{id}'</evaluate>
</ajax-response>
```

–ü–∞—Ä—Å–∏–º URL –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω–µ–≥–æ.

---

## –ë–æ–π (Wicket AJAX)

### –ü–∞—Ä—Å–∏–Ω–≥ URLs
```python
# –ê—Ç–∞–∫–∞
r'"c":"ptx_combat_rich2_attack_link"[^}]*"u":"([^"]+)"'

# –°–∫–∏–ª–ª—ã
r'"c":"id\w+"[^}]*"u":"([^"]*skillLink[^"]*)"'
```

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è Wicket AJAX
```python
headers = {
    "Wicket-Ajax": "true",
    "Wicket-Ajax-BaseURL": "/dungeon/combat/{id}",
    "X-Requested-With": "XMLHttpRequest",
    "Accept": "*/*",
}
```

---

## –§–∞–π–ª—ã –º–æ–¥—É–ª—è

```
requests_bot/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ client.py           # VMMOClient - HTTP —Å–µ—Å—Å–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ combat.py           # CombatClient, CombatParser - –±–æ–π
‚îú‚îÄ‚îÄ mail.py             # MailClient - —Å–±–æ—Ä –ø–æ—á—Ç—ã
‚îú‚îÄ‚îÄ backpack.py         # BackpackClient - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—é–∫–∑–∞–∫–æ–º
‚îú‚îÄ‚îÄ auction.py          # AuctionClient - –ø—Ä–æ–¥–∞–∂–∞ –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ
‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –±–æ—è –≤ Hell Games
‚îú‚îÄ‚îÄ run_dungeon.py      # –ü–æ–ª–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–∂–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ test_dungeons.py    # –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –≤—Ö–æ–¥–∞ –≤ –¥–∞–Ω–∂–µ–Ω + –∞—Ç–∞–∫–∞
‚îú‚îÄ‚îÄ skill_cd_observer.py # –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ö–î —Å–∫–∏–ª–ª–æ–≤
‚îú‚îÄ‚îÄ CONTEXT.md          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ html_*.html         # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ api_*.json          # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ API –æ—Ç–≤–µ—Ç—ã
‚îî‚îÄ‚îÄ ajax_*.xml          # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ AJAX –æ—Ç–≤–µ—Ç—ã
```

---

## –ó–∞–ø—É—Å–∫

```bash
# –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ flow –¥–∞–Ω–∂–µ–Ω–æ–≤ (–≤—Ö–æ–¥ + –∞—Ç–∞–∫–∞)
python -m requests_bot.test_dungeons

# –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
python -m requests_bot.client

# –ë–æ–π –≤ Hell Games (–Ω—É–∂–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π –±–æ–π)
python -m requests_bot.main --attacks 50

# –¢–µ—Å—Ç –ø–æ—á—Ç—ã
python -m requests_bot.mail

# –¢–µ—Å—Ç —Ä—é–∫–∑–∞–∫–∞ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)
python -m requests_bot.backpack

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä—é–∫–∑–∞–∫–∞ (–∞—É–∫—Ü–∏–æ–Ω + —Ä–∞–∑–±–æ—Ä–∫–∞)
python -m requests_bot.backpack --cleanup

# –¢–æ–ª—å–∫–æ —Ä–∞–∑–±–æ—Ä–∫–∞
python -m requests_bot.backpack --disassemble

# –¢–æ–ª—å–∫–æ –∞—É–∫—Ü–∏–æ–Ω
python -m requests_bot.backpack --auction

# –¢–µ—Å—Ç –∞—É–∫—Ü–∏–æ–Ω–∞ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)
python -m requests_bot.auction
```

---

## –ó–∞–º–µ—Ç–∫–∏

- `pageId` –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–∑ `window.ptxPageId`
- `jsessionid` –≤ URL –º–æ–∂–Ω–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ—Å–ª–∏ –µ—Å—Ç—å cookie `JSESSIONID`
- –ö–î –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö, –¥–µ–ª–∏—Ç—å –Ω–∞ 1000 –¥–ª—è —Å–µ–∫—É–Ω–¥
- –î–∞–Ω–∂–µ–Ω—ã –±–µ–∑ `cooldown` –ø–æ–ª—è –∏–ª–∏ —Å `cooldown: 0` - –¥–æ—Å—Ç—É–ø–Ω—ã
- **–í–ê–ñ–ù–û**: –ø–∞—Ä–∞–º–µ—Ç—Ä `link_id`, –Ω–µ `dungeon_id`!
- –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª—è—Ç—å `/normal` –∫ landing URL
- `1=normal` vs `1=impossible` - —Ä–µ–∂–∏–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤ URL

---

## TODO

1. [x] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
2. [x] API –¥–∞–Ω–∂–µ–Ω–æ–≤
3. [x] –í—Ö–æ–¥ –≤ –¥–∞–Ω–∂–µ–Ω —á–µ—Ä–µ–∑ apiLinkUrl (–ø–∞—Ä–∞–º–µ—Ç—Ä link_id!)
4. [x] Landing page ‚Üí Enter button
5. [x] Lobby ‚Üí Start Combat
6. [x] Combat ‚Üí Attack
7. [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
8. [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–æ—è
9. [x] –¶–∏–∫–ª –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∞–Ω–∂–µ–Ω–∞ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ—ë–≤)
10. [x] –¶–∏–∫–ª –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–∞–Ω–∂–µ–Ω–∞–º
11. [x] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–º–µ—Ä—Ç–∏
12. [ ] –í–æ—Å–∫—Ä–µ—à–µ–Ω–∏–µ (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Å–º–µ—Ä—Ç–∏)
13. [x] –ü–æ—á—Ç–∞ - —Å–±–æ—Ä –ø–∏—Å–µ–º –∏ –¥–µ–Ω–µ–≥
14. [x] –†—é–∫–∑–∞–∫ - –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ä–∞–∑–±–æ—Ä–∫–∞, –≤—ã–±—Ä–æ—Å
15. [x] –ê—É–∫—Ü–∏–æ–Ω - –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –∞–≤—Ç–æ—Ü–µ–Ω–æ–π

---

## run_dungeon.py - –ü–æ–ª–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–∂–µ–Ω–æ–≤

### –ó–∞–ø—É—Å–∫
```bash
python -m requests_bot.run_dungeon
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç
1. –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è
2. –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–∂–µ–Ω–æ–≤ (–±–µ–∑ –ö–î)
3. –ü–æ –æ—á–µ—Ä–µ–¥–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–π –¥–∞–Ω–∂–µ–Ω
4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∫–∏–ª–ª—ã + –∞—Ç–∞–∫–∏
5. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
6. –ü—Ä–∏ —Å–º–µ—Ä—Ç–∏ - –≤–æ—Å–∫—Ä–µ—à–∞–µ—Ç—Å—è –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç
7. –í—ã–≤–æ–¥–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### Blacklist –¥–∞–Ω–∂–µ–Ω–æ–≤
–í `SKIP_DUNGEONS` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å ID –¥–∞–Ω–∂–µ–Ω–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å:
```python
SKIP_DUNGEONS = [
    "dng:RestMonastery",  # –ú–æ–Ω–∞—Å—Ç—ã—Ä—å –ø–æ–∫–æ—è - —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–π
]
```

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –ü–∞—Ä—Å–µ—Ä –ö–î —Å–∫–∏–ª–ª–æ–≤ –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å (–¥–æ–±–∞–≤–ª–µ–Ω rate limit)
- –ò–º–µ–Ω–∞ –≤—Ä–∞–≥–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ "Unknown" (–Ω—É–∂–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –∏–º—ë–Ω)

---

## –ö—É–ª–¥–∞—É–Ω—ã —Å–∫–∏–ª–ª–æ–≤

**–ß–µ—Ä–µ–∑ requests –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –ö–î —Å–∫–∏–ª–ª–æ–≤!**

–ü—Ä–∏—á–∏–Ω–∞:
- HTML –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—á–Ω—ã–π
- `.time-counter` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è JavaScript'–æ–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- Playwright —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä —Å JS –¥–≤–∏–∂–∫–æ–º

**–†–µ—à–µ–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ö–î –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å.

### ‚úÖ –ò–ó–ú–ï–†–ï–ù–û (2024-12-18) —á–µ—Ä–µ–∑ skill_cd_observer.py

| –°–∫–∏–ª–ª | –†–µ–∞–ª—å–Ω—ã–π –ö–î | –í –∫–æ–¥–µ (+0.5s –±—É—Ñ–µ—Ä) |
|-------|-------------|---------------------|
| 1 | ~15s | 15.5s |
| 2 | ~24s | 24.5s |
| 3 | ~39s | 39.5s |
| 4 | ~54s | 54.5s |
| 5 | ~42s | 42.5s |

```python
# run_dungeon.py
SKILL_CDS = {
    1: 15.5,
    2: 24.5,
    3: 39.5,
    4: 54.5,
    5: 42.5,
}
```

### skill_cd_observer.py
–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ö–î —Å–∫–∏–ª–ª–æ–≤:
```bash
python -m requests_bot.skill_cd_observer --duration 5
```
- –ò–∑–º–µ—Ä—è–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è–º–∏ –æ–¥–Ω–æ–≥–æ —Å–∫–∏–ª–ª–∞
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—á—ë—Ç –≤ `skill_cd_report.txt`
- –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `skill_cd_log.json`

---

## –ê–¥—Å–∫–∏–µ –ò–≥—Ä—ã (Hell Games)

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í—Ö–æ–¥ –≤ –ê–¥—Å–∫–∏–µ –ò–≥—Ä—ã (`/basin/combat`)
- –ë–æ–π (–∞—Ç–∞–∫–∏ + —Å–∫–∏–ª–ª—ã)
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (light/dark)
- –ü–æ–∏—Å–∫ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (`find_enemy_source()`)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏
```python
# –ö–ª–∞—Å—Å—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
# _side-light = –≤—Ä–∞–∂–µ—Å–∫–∏–π
# _side-dark = –Ω–∞—à
# _current = —Ç–µ–∫—É—â–∏–π
# _lock = –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

parser.get_sources_info()  # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å —Ñ–ª–∞–≥–∞–º–∏
parser.find_enemy_source() # –ù–∞–π—Ç–∏ –≤—Ä–∞–∂–µ—Å–∫–∏–π –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
```

---

## –ü–æ—á—Ç–∞ (mail.py)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from requests_bot.client import VMMOClient
from requests_bot.mail import MailClient

client = VMMOClient()
client.load_cookies()

mail = MailClient(client)
stats = mail.check_and_collect()
# stats = {"messages": 5, "gold": 100, "silver": 50, "expired_items": ["–ú–µ—á"]}
```

### –ú–µ—Ç–æ–¥—ã
- `has_mail_notification()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–Ω–∞—á–æ–∫ –ø–æ—á—Ç—ã
- `open_mailbox()` - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/message/list`
- `find_active_messages()` - —Å–ø–∏—Å–æ–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∏—Å–µ–º
- `parse_mail_money()` - –ø–∞—Ä—Å–∏—Ç –∑–æ–ª–æ—Ç–æ/—Å–µ—Ä–µ–±—Ä–æ –∏–∑ –ø–∏—Å—å–º–∞
- `collect_message_items()` - –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞–±—Ä–∞—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å"
- `check_and_collect(on_backpack_full)` - —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å—ë, callback –ø—Ä–∏ –ø–æ–ª–Ω–æ–º —Ä—é–∫–∑–∞–∫–µ

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã
- –ü–∏—Å—å–º–∞: `a.task-section._label.brass` (–±–µ–∑ `c-verygray` –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö)
- –î–µ–Ω—å–≥–∏: `div.p2` —Å `span.i12-money_gold`, `span.i12-money_silver`
- –ö–Ω–æ–ø–∫–∞: `a.btn.nav-btn` —Å —Ç–µ–∫—Å—Ç–æ–º "–ó–∞–±—Ä–∞—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å"

---

## –†—é–∫–∑–∞–∫ (backpack.py)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from requests_bot.backpack import BackpackClient

backpack = BackpackClient(client)
backpack.cleanup_if_needed()  # –û—á–∏—Å—Ç–∏—Ç –µ—Å–ª–∏ >= 15 –ø—Ä–µ–¥–º–µ—Ç–æ–≤
```

### –ú–µ—Ç–æ–¥—ã
- `get_backpack_count()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `(current, total)`
- `need_cleanup()` - True –µ—Å–ª–∏ >= BACKPACK_THRESHOLD (15)
- `is_full()` - True –µ—Å–ª–∏ current >= total
- `open_backpack()` - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä—é–∫–∑–∞–∫–∞
- `get_items()` - —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Å –∫–Ω–æ–ø–∫–∞–º–∏
- `disassemble_item(item)` - —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç
- `drop_item(item)` - –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç
- `open_bonus(item)` - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ–Ω—É—Å
- `cleanup(max_pages)` - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

### –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (PROTECTED_ITEMS)
–ù–µ –ø—Ä–æ–¥–∞—é—Ç—Å—è –∏ –Ω–µ —Ä–∞–∑–±–∏—Ä–∞—é—Ç—Å—è:
- –ñ–µ–ª–µ–∑–æ, –ñ–µ–ª–µ–∑–Ω–∞—è –†—É–¥–∞, –ñ–µ–ª–µ–∑–Ω—ã–π –°–ª–∏—Ç–æ–∫
- –û—Å–∫–æ–ª–∫–∏ (–ì—Ä—ë–∑, –ü–æ—Ä—è–¥–∫–∞, –†–∞—Å—Å–≤–µ—Ç–∞, –ù–æ—á–∏, –¢–µ–Ω–∏, –•–∞–æ—Å–∞)
- –¢—Ä–µ—Å–Ω—É—Ç—ã–π –ö—Ä–∏—Å—Ç–∞–ª–ª –¢–∏–∫—É–∞–Ω–∞
- –ü–µ—á–∞—Ç—å –°—Ç–∞–ª–∫–µ—Ä–∞ (I, II, III)
- –õ–µ–¥—è–Ω–æ–π –ö—Ä–∏—Å—Ç–∞–ª–ª, –£–≥–æ–ª—å –≠—Ñ–∏—Ä–Ω–æ–≥–æ –î—Ä–µ–≤–∞

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã
- –ü—Ä–µ–¥–º–µ—Ç: `div.p10`
- –ù–∞–∑–≤–∞–Ω–∏–µ: `span.e-name a` (–∫–ª–∞—Å—Å `iGood` = –∑–µ–ª—ë–Ω—ã–π)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: `span.e-count` (—Ñ–æ—Ä–º–∞—Ç "x5" –∏–ª–∏ " —Ö10")
- –ö–Ω–æ–ø–∫–∏: `a.go-btn` —Å —Ç–µ–∫—Å—Ç–æ–º "–ù–∞ –∞—É–∫—Ü–∏–æ–Ω", "–†–∞–∑–æ–±—Ä–∞—Ç—å", "–í—ã–∫–∏–Ω—É—Ç—å", "–û—Ç–∫—Ä—ã—Ç—å"

---

## –ê—É–∫—Ü–∏–æ–Ω (auction.py)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from requests_bot.auction import AuctionClient

auction = AuctionClient(client)
stats = auction.sell_all()
# stats = {"listed": 3, "disassembled": 2, "errors": 0}
```

### –õ–æ–≥–∏–∫–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
1. –ü–æ–ª—É—á–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
2. –î–µ–ª–∏–º –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –ª–æ—Ç–µ ‚Üí —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
3. –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –Ω–∞—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
4. –í—ã—á–∏—Ç–∞–µ–º 1 —Å–µ—Ä–µ–±—Ä–æ
5. –ú–∏–Ω–∏–º—É–º 5 —Å–µ—Ä–µ–±—Ä–∞

### –ó–µ–ª—ë–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–∏—Ä–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–æ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω.

### –ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (auction_blacklist.json)
–ü—Ä–µ–¥–º–µ—Ç—ã —Å –∏—Å—Ç–µ–∫—à–∏–º —Å—Ä–æ–∫–æ–º –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ blacklist –∏ –±–æ–ª—å—à–µ –Ω–µ –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è.

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã
- –ù–∞—à —Ç–æ–≤–∞—Ä: `div.panel-inner-2`
- –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã: `div.list-el` (–ø–µ—Ä–≤—ã–π = –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞)
- –¶–µ–Ω–∞ –≤—ã–∫—É–ø–∞: `a.go-btn._auction` —Å `span.i12-money_gold/silver`
- –ü–æ–ª—è —Ü–µ–Ω—ã: `input[name='bidGold/bidSilver/buyoutGold/buyoutSilver']`
- –ö–Ω–æ–ø–∫–∞: `input.go-btn[value='–°–æ–∑–¥–∞—Ç—å –ª–æ—Ç']`
- –û—à–∏–±–∫–∞: `span.feedbackPanelERROR` (—Ç–µ–∫—Å—Ç "–Ω–∏–∂–µ —Ä—ã–Ω–æ—á–Ω–æ–π")
