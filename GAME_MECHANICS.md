# Механика игры VMMO

## Адские Игры (Hell Games) - /basin/combat

### Суть
Две стороны (Свет и Тьма) сражаются за контроль над источниками.

### Источники
- Всего **6 источников**
- Каждый источник принадлежит одной из сторон
- У каждого источника есть **Хранитель** - босс который его защищает

### Механика захвата
1. Убиваешь вражеского хранителя → источник становится твоей стороны
2. Появляется твой хранитель
3. Враги могут убить твоего хранителя → источник снова их

### Переходы между источниками
**ВАЖНО:** Нельзя перейти в другой источник пока жив хранитель в текущем источнике!

Если хранитель жив:
- Ты заперт в этом источнике
- Нужно либо убить вражеского хранителя, либо ждать пока союзники убьют

### Хранитель
- **Позиция 22** = вражеский хранитель (которого надо убить)
- **Позиция 11** = наш хранитель (защищает захваченный источник)
- Класс `._keeper` - это хранитель
- Класс `._own` или `._own-death` - наш юнит

### Стороны персонажей
- Светлые персонажи атакуют тёмные источники
- Тёмные персонажи атакуют светлые источники
- В конфиге профиля: `is_light_side: true/false`

---

## Данжены

### Сложности (URL параметры)
- `1=impossible` = Брутал
- `1=hard` = Героик
- `1=normal` = Нормал

### Вкладки
- `tab2` = 50+ уровень
- `tab3` = 30-39 уровень

---

## Боевая система

### Позиции юнитов
- 11-15: первый ряд
- 21-25: второй ряд (враги)

### Таймеры
- GCD (глобальный кулдаун): 2.0 сек
- Атака: 0.6 сек между ударами

### Wicket AJAX
Игра использует Apache Wicket. Все действия через AJAX:
- Атака: `...attackBlock-attackBlockInner-attackLink`
- Скиллы: `...skills-{N}-skillBlock-skillBlockInner-skillLink`
- Refresher (сбор лута): `...battlefield-refresher`

---

## Лут

### Сбор лута
- `lootTakeUrl` + ID лута = забрать предмет
- Refresher нужен для появления лута в ответе
- Без heartbeat/refresher лут не собирается автоматически
